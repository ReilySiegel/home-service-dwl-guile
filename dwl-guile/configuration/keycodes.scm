(define-module (dwl-guile configuration keycodes)
  #:use-module (ice-9 match)
  #:use-module (ice-9 exceptions)
  #:export (string->keycode))

;; Converts keysyms to the corresponding keycode.
;; Only the most common keysyms are supported.
;;
;; Most keysyms follows the same naming convention as Emacs,
;; with the exceptions of some obscure keys. XF86 keys are defined
;; using pascal case, e.g. <XF86MonBrightnessDown>.
;;
;; These keycodes have been extracted from the dwl patch at:
;; https://github.com/djpohly/dwl/compare/main...Sevz17:keycodes.patch
(define (string->keycode str)
  (match str
    ("<escape>" 9)
    ("1" 10)
    ("2" 11)
    ("3" 12)
    ("4" 13)
    ("5" 14)
    ("6" 15)
    ("7" 16)
    ("8" 17)
    ("9" 18)
    ("0" 19)
    ("-" 20)
    ("=" 21)
    ("<backspace>" 22)
    ("<tab>" 23)
    ("q" 24)
    ("w" 25)
    ("e" 26)
    ("r" 27)
    ("t" 28)
    ("y" 29)
    ("u" 30)
    ("i" 31)
    ("o" 32)
    ("p" 33)
    ("[" 34)
    ("]" 35)
    ("<return>" 36)
    ("a" 38)
    ("s" 39)
    ("d" 40)
    ("f" 41)
    ("g" 42)
    ("h" 43)
    ("j" 44)
    ("k" 45)
    ("l" 46)
    (";" 47)
    ("'" 48)
    ("`" 49)
    ("\\" 51)
    ("z" 52)
    ("x" 53)
    ("c" 54)
    ("v" 55)
    ("b" 56)
    ("n" 57)
    ("m" 58)
    ("," 59)
    ("." 60)
    ("/" 61)
    ("<kp-multiply>" 63)
    ("<space>" 65)
    ("<Caps_Lock>" 66)
    ("<f1>" 67)
    ("<f2>" 68)
    ("<f3>" 69)
    ("<f4>" 70)
    ("<f5>" 71)
    ("<f6>" 72)
    ("<f7>" 73)
    ("<f8>" 74)
    ("<f9>" 75)
    ("<f10>" 76)
    ("<Num_Lock>" 77)
    ("<Scroll_Lock>" 78)
    ("<kp-home>" 79)
    ("<kp-7>" 79)
    ("<kp-up>" 80)
    ("<kp-8>" 80)
    ("<kp-prior>" 81)
    ("<kp-9>" 81)
    ("<kp-subtract>" 82)
    ("<kp-left>" 83)
    ("<kp-4>" 83)
    ("<kp-begin>" 84)
    ("<kp-5>" 84)
    ("<kp-right>" 85)
    ("<kp-6>" 85)
    ("<kp-add>" 86)
    ("<kp-end>" 87)
    ("<kp-1>" 87)
    ("<kp-down>" 88)
    ("<kp-2>" 88)
    ("<kp-next>" 89)
    ("<kp-3>" 89)
    ("<kp-insert>" 90)
    ("<kp-0>" 90)
    ("<kp-delete>" 91)
    ("<kp-period>" 90)
    ("<less>" 94)
    ("<f11>" 95)
    ("<f12>" 96)
    ("<kp-enter>" 104)
    ("<kp-divide>" 106)
    ("<print>" 107)
    ("<home>" 110)
    ("<up>" 111)
    ("<prior>" 112)
    ("<left>" 113)
    ("<right>" 114)
    ("<end>" 115)
    ("<down>" 116)
    ("<next>" 117)
    ("<insert>" 118)
    ("<delete>" 119)
    ("<XF86AudioMute>" 121)
    ("<XF86AudioLowerVolume>" 122)
    ("<XF86AudioRaiseVolume>" 123)
    ("<XF86PowerOff>" 124)
    ("<kp-equal>" 125)
    ("<plusminus>" 126)
    ("<pause>" 127)
    ("<XF86LaunchA>" 128)
    ("<kp-decimal>" 129)
    ("<menu>" 135)
    ("<cancel>" 136)
    ("<redo>" 137)
    ("<undo>" 139)
    ("<XF86Copy>" 141)
    ("<XF86Open>" 142)
    ("<XF86Paste>" 143)
    ("<find>" 144)
    ("<XF86Cut>" 145)
    ("<help>" 146)
    ("<XF86MenuKB>" 147)
    ("<XF86Calculator>" 148)
    ("<XF86Sleep>" 150)
    ("<XF86WakeUp>" 151)
    ("<XF86Explorer>" 152)
    ("<XF86Send>" 153)
    ("<XF86Xfer>" 155)
    ("<XF86Launch1>" 156)
    ("<XF86Launch2>" 157)
    ("<XF86WWW>" 158)
    ("<XF86DOS>" 159)
    ("<XF86ScreenSaver>" 160)
    ("<XF86RotateWindows>" 161)
    ("<XF86TaskPane>" 162)
    ("<XF86Mail>" 163)
    ("<XF86Favorites>" 164)
    ("<SunFront>" 140)
    ("<XF86MyComputer>" 165)
    ("<XF86Back>" 166)
    ("<XF86Forward>" 167)
    ("<XF86Eject1>" 169)
    ("<XF86Eject2>" 170)
    ("<XF86AudioNext>" 171)
    ("<XF86AudioPlay>" 172)
    ("<XF86AudioPrev>" 173)
    ("<XF86AudioStop>" 174)
    ("<XF86AudioRecord>" 175)
    ("<XF86AudioRewind>" 176)
    ("<XF86Phone>" 177)
    ("<XF86Tools>" 179)
    ("<XF86HomePage>" 180)
    ("<XF86Reload>" 181)
    ("<XF86Close>" 182)
    ("<XF86ScrollUp>" 185)
    ("<XF86ScrollDown>" 186)
    ("(" 187)
    (")" 188)
    ("<XF86New>" 189)
    ("<XF86Tools2>" 191)
    ("<XF86Launch5>" 192)
    ("<XF86Launch6>" 193)
    ("<XF86Launch7>" 194)
    ("<XF86Launch8>" 195)
    ("<XF86Launch9>" 196)
    ("<XF86AudioMicMute>" 198)
    ("<XF86TouchpadToggle>" 199)
    ("<XF86TouchpadOn>" 200)
    ("<XF86TouchpadOff>" 201)
    ("<XF86AudioPlay2>" 208)
    ("<XF86AudioPause>" 209)
    ("<XF86Launch3>" 210)
    ("<XF86Launch4>" 211)
    ("<XF86LaunchB>" 212)
    ("<XF86Suspend>" 213)
    ("<XF86Close2>" 214)
    ("<XF86AudioPlay3>" 215)
    ("<XF86AudioForward>" 216)
    ("<XF86WebCam>" 220)
    ("<XF86AudioPreset>" 221)
    ("<XF86Mail2>" 223)
    ("<XF86Messenger>" 224)
    ("<XF86Search>" 225)
    ("<XF86Go>" 226)
    ("<XF86Finance>" 227)
    ("<XF86Game>" 228)
    ("<XF86Shop>" 229)
    ("<XF86MonBrightnessDown>" 232)
    ("<XF86MonBrightnessUp>" 233)
    ("<XF86AudioMedia>" 234)
    ("<XF86Display>" 235)
    ("<XF86KbdLightOnOff>" 236)
    ("<XF86KbdBrightnessDown>" 237)
    ("<XF86KbdBrightnessUp>" 238)
    ("<XF86Send2>" 239)
    ("<XF86Reply>" 240)
    ("<XF86MailForward>" 241)
    ("<XF86Save>" 242)
    ("<XF86Documents>" 243)
    ("<XF86Battery>" 244)
    ("<XF86Bluetooth>" 245)
    ("<XF86WLAN>" 246)
    ("<XF86MonBrightnessCycle>" 251)
    ("<XF86WWAN>" 254)
    ("<XF86RFKill>" 255)
    ;; TODO: Support more mouse buttons
    ("<mouse-1>" 'MOUSE-LEFT)
    ("<mouse-left>" 'MOUSE-LEFT)
    ("<mouse-2>" 'MOUSE-RIGHT)
    ("<mouse-right>" 'MOUSE-RIGHT)
    ("<mouse-3>" 'MOUSE-MIDDLE)
    ("<mouse-middle>" 'MOUSE-MIDDLE)
    (_ (raise-exception
        (make-exception-with-message
         (string-append "dwl: no conversion for keysym '"
                        str
                        "', use keycode instead"))))))
